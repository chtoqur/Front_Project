<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- loop = 끝나면 처음부터 다시 재생 -->
    <!-- controls = 재생바 생성 -->


    <video src="./video/apple.mp4"></video>
    
    <video src="./video/apple.mp4" autoplay loop muted controls></video>




    <button>STOP</button>
    <canvas id="canvas" width="1920" height="1080"></canvas>

    <script>
        // 1. 캔버스 및 컨텍스트를 가지고 온다.
        const canvas = document.querySelector('#canvas');
        const ctx = canvas.getContext('2d');

        // 2. 이미지를 불러온다.
        const imgCount = 570;
        let imgElement;
        let imgArray = [];

        // 2-1. 이미지를 불러와서 배열에 넣는다.
        for(let i = 0; i < imgCount; i++)
        {
            // new는 키워드
            // image객체를 Heap Area에 할당하는 것 > 참조값이 만들어짐
            // 참조값이 imgElement에 들어가는 것
            imgElement = new Image();
            imgElement.src = `./image/apple_${i}.png`;
            console.log(`./image/apple_${i}.png`);

            // 그 참조값을 배열에 넣는다.
            imgArray.push(imgElement);
        }

        // load 이벤트는 로딩해야 할 리소스가 모두 로딩되면 발생하는 이벤트
        // 노드에는 이벤트 리스너를 붙일 수 있음
        imgElement.addEventListener('load', ()=>{
            ctx.drawImage(imgArray[0], 0, 0);
            timerId()
        });

        ctx.fillStyle = 'green';
        ctx.fillRect(10, 10, 100, 100);

        // 타이머를 이용한 애니메이션
        // 버튼 누르면 stop

        let imgIndex = 0;
        const timerId = setInterval(()=>{
            
            ctx.drawImage(imgArray[imgIndex], 0, 0);
            imgIndex++;
            
            if (imgIndex === imgCount)
            {
                imgIndex = 0;
            }
            
        }, 30)
        
        const $btn = document.querySelector("button");

        $btn.addEventListener("click", ()=>{
            clearTimeout(timerId)
            // = clearInterval(timerId)
        });

    </script>
</body>
</html>